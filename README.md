# CoopCredit System

A comprehensive, production-ready backend system for credit application management, built with Java 21, Spring Boot, and Hexagonal Architecture.

## üèóÔ∏è Architecture

The system follows a Hexagonal Architecture (Ports and Adapters) pattern to ensure separation of concerns and maintainability.

### Microservices
1.  **credit-application-service**: The core domain service request handling, business logic, and persistence.
2.  **risk-central-mock-service**: A mock external service that simulates risk evaluation logic.

### Technology Stack
-   **Language**: Java 21
-   **Framework**: Spring Boot 3.5.0
-   **Database**: MySQL 8.0
-   **Migrations**: Flyway
-   **Security**: Spring Security + JWT (Stateless)
-   **Mapping**: MapStruct
-   **Testing**: JUnit 5, Mockito, Testcontainers
-   **Containerization**: Docker & Docker Compose

## üöÄ Getting Started

### Prerequisites
-   Docker and Docker Compose installed.
-   Java 21 (optional, if running locally without Docker).
-   Maven (optional, wrapper included).

### Running with Docker (Recommended)

1.  Clone the repository.
2.  Navigate to the project root.
3.  Run the system:
    ```bash
    docker-compose up --build
    ```
4.  The services will be available at:
    -   **Credit Service**: `http://localhost:8080`
    -   **Risk Mock**: `http://localhost:8081`
    -   **Swagger UI**: `http://localhost:8080/swagger-ui.html`

### Running Locally

1.  Start MySQL (ensure port 3306 is available or update config).
    ```bash
    docker run -p 3306:3306 -e MYSQL_ROOT_PASSWORD=1234 -e MYSQL_DATABASE=coopcredit_db mysql:8.0
    ```
2.  Run Risk Central Mock:
    ```bash
    cd risk-central-mock-service
    ./mvnw spring-boot:run
    ```
3.  Run Credit Application Service:
    ```bash
    cd credit-application-service
    ./mvnw spring-boot:run
    ```

## üîë Security & Roles

The system is secured via JWT. You must authenticate to access protected endpoints.

**Default Users (Created by Migration V3):**

| Role | Username | Password | Access |
| :--- | :--- | :--- | :--- |
| **ADMIN** | `admin` | `admin123` | Full access |
| **ANALYST** | `analyst` | `analyst123` | View & Evaluate applications |

**Registration:**
Public endpoints for registration are available at `/api/auth/register`.

## üì¶ API Endpoints

### Authentication
-   `POST /api/auth/login`: Get JWT Token.

### Affiliates
-   `POST /api/affiliates`: Register a new affiliate.
-   `GET /api/affiliates/{id}`: Get affiliate details.

### Credit Applications
-   `POST /api/credit-applications`: Create a new credit application.
-   `GET /api/credit-applications`: List applications.
-   `PUT /api/credit-applications/{id}/status`: Update status (Analyst/Admin only).

## üß™ Testing

Run integration tests using Testcontainers:

```bash
cd credit-application-service
./mvnw test
```

## üìä Observability
Health and metrics are exposed via Spring Boot Actuator:
-   `http://localhost:8080/actuator/health`
-   `http://localhost:8080/actuator/prometheus`

---
*Generated by Antigravity Agent*